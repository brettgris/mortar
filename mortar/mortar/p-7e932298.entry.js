import{r as s,c as t,h as i,g as h}from"./p-35a71817.js";import"./p-74149bb1.js";import{c as e}from"./p-49401b94.js";const o=class{constructor(i){s(this,i),this.size="md",this.label="",this.help="",this.haserror=!1,this.error="",this.placeholder="",this.disabled=!1,this.open=!1,this.focused=!1,this.highlight=-1,this.value="",this.className=()=>e("dropdown-outer",`${this.size}`,{"is-open":!0===this.open,"is-focused":!0===this.focused,"is-disabled":!0===this.disabled,"has-error":!0===this.haserror}),this.dropClassName=()=>e("dropdown-list","dropdown-list-dropdown",{"is-active":!0===this.open}),this.displayClassName=()=>e("dropdown-item","dropdown-item-selectable",{"dropdown-placeholder":!this.value}),this.handleClick=()=>{this.disabled||(this.open=!this.open)},this.handleFocus=()=>{this.disabled||(this.focused=!0)},this.handleBlur=()=>{this.disabled||(this.focused=!1,this.open=!1)},this.handleListClick=s=>{const t=s.target,i=t.getAttribute("data-value");if(null===t.getAttribute("data-disabled")){const s=this.options.find(s=>s.value===i);s&&this.handleItemSelect(s)}},this.handleItemSelect=s=>{if(!0!==s.disabled){const t=this.getCurrent();t&&(t.selected=!1),s.selected=!0,this.value=s.value,this.itemSelect.emit(s),this.open=!1}},this.handleDropdownRef=s=>{this.dropdownEl=s},this.loadOptions=()=>{this.options=Array.prototype.slice.call(this.el.querySelectorAll("mortar-dropdown-item"));const s=this.options.find(s=>!0===s.selected);s&&(this.value=s.value)},this.getAvailable=()=>this.options.reduce((s,t,i)=>(t.disabled||s.push({o:t,k:i}),s),[]),this.getCurrent=()=>this.value&&this.options&&this.options.find(s=>s.value===this.value)||null,this.clearHighlight=()=>{const s=this.options[this.highlight];s&&(s.highlighted=!1),this.highlight=-1},this.setHighlight=s=>{const t=this.getAvailable();if(s)if(-1===this.highlight){let s=0;this.value&&(s=t.find(s=>s.o.value===this.value).k),this.highlight=s,this.options[s].highlighted=!0}else{this.options[this.highlight].highlighted=!1;const s=t.find(s=>s.k>this.highlight);this.highlight=s?s.k:t[0].k,this.options[this.highlight].highlighted=!0}else{const s=t.reverse();if(-1===this.highlight){let t=0;this.value&&(t=s.find(s=>s.o.value===this.value).k),this.highlight=t,this.options[t].highlighted=!0}else{this.options[this.highlight].highlighted=!1;const t=s.find(s=>s.k<this.highlight);this.highlight=t?t.k:s[0].k,this.options[this.highlight].highlighted=!0}}this.highlight>-1&&this.options[this.highlight].getEl().then(s=>{this.el.querySelector('.dropdown-list[role="listbox"]').scrollTop=s.offsetTop})},this.selectHighlight=()=>{this.highlight>-1&&this.handleItemSelect(this.options[this.highlight])},this.itemSelect=t(this,"itemSelect",7)}handleOutsideClick(s){!0!==this.open||s.target===this.dropdownEl||this.dropdownEl.contains(s.target)||(this.open=!1)}componentWillLoad(){this.loadOptions()}handleOpen(s){if(s){if(this.value){const s=this.getCurrent();s&&s.getEl().then(s=>{this.el.querySelector('.dropdown-list[role="listbox"]').scrollTop=s.offsetTop})}}else this.clearHighlight()}handleKeySelect(s){this.open?(38===s.keyCode&&(s.preventDefault(),this.setHighlight(!1)),40===s.keyCode&&(s.preventDefault(),this.setHighlight(!0)),13!==s.keyCode&&32!==s.keyCode||(s.preventDefault(),this.selectHighlight(),this.open=!1),27===s.keyCode&&(s.preventDefault(),this.open=!1)):this.focused&&(13!==s.keyCode&&32!==s.keyCode||(s.preventDefault(),this.open=!0))}render(){const s=this.getCurrent();return i("mortar-form-element",{label:this.label,help:this.help,haserror:this.haserror,error:this.error,elementclass:"dropdown",ref:this.handleDropdownRef},i("div",{class:this.className(),tabindex:"0",role:"listbox","aria-haspopup":"true","aria-expanded":this.open,onFocus:this.handleFocus,onBlur:this.handleBlur},i("div",{class:"dropdown-inner",onClick:this.handleClick},i("div",{class:"dropdown-list dropdown-list-single"},i("div",{class:this.displayClassName(),"aria-selected":"true"},s?s.label:this.placeholder))),i("div",{class:this.dropClassName(),"aria-expanded":this.open},i("div",{class:"dropdown-list",role:"listbox",onClick:this.handleListClick},i("slot",null)))))}get el(){return h(this)}static get watchers(){return{open:["handleOpen"]}}},r=class{constructor(t){s(this,t),this.disabled=!1,this.highlighted=!1,this.selected=!1,this.label="",this.value="",this.className=()=>e("dropdown-item","dropdown-item-choice",{"dropdown-item-selectable":!this.disabled,"dropdown-item-disabled":this.disabled,"is-highlighted":!this.disabled&&this.highlighted})}async getEl(){return this.root}render(){return i("div",{class:this.className(),role:"option","aria-selected":this.selected,"data-value":this.value,"data-disabled":this.disabled},this.label)}get root(){return h(this)}};export{o as mortar_dropdown,r as mortar_dropdown_item}