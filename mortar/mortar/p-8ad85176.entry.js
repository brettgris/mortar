import{r as t,h as s,c as i,g as e}from"./p-77e8c3a9.js";import"./p-74149bb1.js";import{c as h}from"./p-49401b94.js";import{f as a}from"./p-8ec6ee43.js";const n=class{constructor(e){t(this,e),this.days=["S","M","T","W","R","F","S"],this.months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.monthPlaceholder="Month",this.yearPlaceholder="Year",this.open=!1,this.focused=!1,this.highlight=-1,this.header=!0,this.embed=!1,this.customClass=()=>"",this.getAvailableMonths=()=>this.months.map((t,s)=>({label:t,value:s})),this.getAvailableYears=()=>{const t=new Date,s=this.minDate||new Date(t.getFullYear()-5,t.getMonth(),t.getDate()),i=this.maxDate||new Date(t.getFullYear()+5,t.getMonth(),t.getDate()),e=s.getFullYear(),h=i.getFullYear();return Array.apply(null,Array(h-e+1)).map((t,s)=>({value:e+s,label:e+s}))},this.getMonthValue=()=>{const t=this.current||this.selected||this.getDefaultDate();return{value:t.getMonth(),label:this.months[t.getMonth()]}},this.getYearValue=()=>{const t=this.current||this.selected||this.getDefaultDate();return{value:t.getFullYear(),label:t.getFullYear()}},this.handleClear=()=>{this.current=null,this.selected=null,this.clearDate.emit()},this.changeCurrent=(t,s,i=-1)=>{let e=new Date(s,t);if(this.minDate){const t=new Date(this.minDate.getFullYear(),this.minDate.getMonth());e<t&&(e=t)}if(this.maxDate){const t=new Date(this.maxDate.getFullYear(),this.maxDate.getMonth());e>t&&(e=t)}this.current=e,this.highlight=i},this.handleChangeMonth=t=>{const s=this.current||this.selected||this.getDefaultDate();let i=s.getMonth()+t,e=s.getFullYear();-1===i&&(i=11,e--),12===i&&(i=0,e++),this.changeCurrent(i,e)},this.handleChangeCurrentMonth=t=>{const s=this.current||this.selected||this.getDefaultDate();this.changeCurrent(t.detail.value,s.getFullYear())},this.handleChangeCurrentYear=t=>{const s=this.current||this.selected||this.getDefaultDate();this.changeCurrent(s.getMonth(),t.detail.value)},this.getCurrentMonth=()=>{const t=this.current||this.selected||this.getDefaultDate();return`${this.months[t.getMonth()]} ${t.getFullYear()}`},this.getDefaultDate=()=>{let t=new Date;return this.minDate&&t<this.minDate&&(t=this.minDate),this.maxDate&&t>this.maxDate&&(t=this.maxDate),t},this.handleClickDay=(t,s,i)=>{const e=new Date(t,s,i);this.selected=e,this.selectDate.emit(e),this.clickDate.emit(e)},this.handleSelectDay=(t,s,i,e)=>{const h=new Date(t,s,i);this.selected=h,this.selectDate.emit(h),this.keyboardSelect.emit(e)},this.handleCalendarFocus=()=>{this.focused=!0},this.handleCalendarBlur=()=>{this.focused=!1},this.getDaysInMonth=t=>{const s=new Date(t.getFullYear(),t.getMonth()).getDay(),i=40-new Date(t.getFullYear(),t.getMonth(),40).getDate(),e=s+i,h=t.getFullYear(),a=t.getMonth(),n={month:a>0?a-1:11,year:a>0?h:h-1,length:0};n.length=40-new Date(n.year,n.month,40).getDate();const r={month:a<11?a+1:0,year:a<11?h:h+1,length:0};return r.length=40-new Date(r.year,r.month,40).getDate(),{first:s,length:i,total:e,rows:6,year:h,month:a,previous:n,next:r}},this.getCalendarDays=()=>{const t=this.current||this.selected||this.getDefaultDate(),i=this.getDaysInMonth(t);let e=Array.apply(null,Array(i.rows)),h=0,a=0;return e.map((t,e)=>{const n=Array.apply(null,Array(7));return s("div",{class:"datepicker-content-row"},n.map((t,n)=>{if(0===e&&n<i.first){const t=i.previous.length-(i.first-1-n);return s("div",{class:`datepicker-content-item datepicker-content-out ${this.customClass(i.previous.year,i.previous.month,t)}`},s("div",{class:"datepicker-content-display"},s("span",null,t)))}if(h<i.length){h++;const t=h;if(this.isAvailable(i.year,i.month,t)){let e=this.customClass(i.year,i.month,t);return this.isToday(i.year,i.month,t)&&(e+=" datepicker-today"),this.isSelected(i.year,i.month,t)&&(e+=" datepicker-selected"),this.highlight===t&&this.focused&&(e+=" datepicker-highlight"),s("div",{class:`datepicker-content-item ${e}`,onClick:()=>this.handleClickDay(i.year,i.month,t)},s("div",{class:"datepicker-content-display"},s("span",null,t)))}return s("div",{class:`datepicker-content-item datepicker-content-out ${this.customClass(i.year,i.month,t)}`},s("div",{class:"datepicker-content-display"},s("span",null,t)))}return a++,s("div",{class:`datepicker-content-item datepicker-content-out ${this.customClass(i.next.year,i.next.month,a)}`},s("div",{class:"datepicker-content-display"},s("span",null,a)))}))})},this.isToday=(t,s,i)=>{const e=new Date;return t===e.getFullYear()&&s===e.getMonth()&&i===e.getDate()},this.isSelected=(t,s,i)=>this.selected&&t===this.selected.getFullYear()&&s===this.selected.getMonth()&&i===this.selected.getDate(),this.isAvailable=(t,s,i)=>{const e=new Date(t,s,i);return this.minDate&&this.maxDate?e>=this.minDate&&e<=this.maxDate:this.minDate?e>=this.minDate:!this.maxDate||e<=this.maxDate},this.className=()=>h("datepicker-list-outer",{show:this.open,"no-header":!this.header&&this.embed,embed:this.embed}),this.clearDate=i(this,"clearDate",7),this.selectDate=i(this,"selectDate",7),this.clickDate=i(this,"clickDate",7),this.keyboardSelect=i(this,"keyboardSelect",7),this.keyboardExit=i(this,"keyboardExit",7)}handleSelected(t){t||(this.current=null)}handleClose(t){if(t){a.on(this.root);const t=this.root;setTimeout((function(){t.querySelector(".datepicker-body").focus()}),1)}else this.current=null,this.focused=!1,a.off(this.root)}handleFocused(){this.highlight=-1}handleKeySelect(t){if(this.open&&this.focused)switch(t.keyCode){case 37:this.changeHighlight(-1),t.preventDefault();break;case 38:this.changeHighlight(-7),t.preventDefault();break;case 39:this.changeHighlight(1),t.preventDefault();break;case 40:this.changeHighlight(7),t.preventDefault();break;case 13:case 32:this.selectHighlight(t),t.preventDefault()}if(this.open&&27===t.keyCode){const t=Array.prototype.slice.call(this.root.querySelectorAll("mortar-dropdown")).find(t=>t.querySelector(".dropdown-outer")===document.activeElement);t&&t.open||this.embed||(this.open=!1,this.keyboardExit.emit())}}changeHighlight(t){const s=this.current||this.selected||this.getDefaultDate(),i=this.getDaysInMonth(s);if(-1===this.highlight){const t=new Date;this.highlight=this.selected&&this.selected.getMonth()===i.month&&this.selected.getFullYear()===i.year?this.selected.getDate():t.getMonth()===i.month&&t.getFullYear()===i.year?t.getDate():Math.floor(i.length/2)}this.highlight+=t,this.highlight<=0?this.changeCurrent(i.previous.month,i.previous.year,i.previous.length+this.highlight):this.highlight>i.length&&this.changeCurrent(i.next.month,i.next.year,this.highlight-i.length)}selectHighlight(t){if(this.highlight>=0){const s=this.current||this.selected||this.getDefaultDate();this.handleSelectDay(s.getFullYear(),s.getMonth(),this.highlight,t)}}render(){return this.embed?s("fieldset",{class:"datepicker"},this.renderEl()):this.renderEl()}renderEl(){return s("div",{class:this.className()},this.header&&s("div",{class:"datepicker-selector"},s("div",{class:"datepicker-select-dropdown"},s("mortar-dropdown",{options:this.getAvailableMonths(),placeholder:this.monthPlaceholder,value:this.getMonthValue(),onItemSelect:this.handleChangeCurrentMonth})),s("div",{class:"datepicker-select-dropdown"},s("mortar-dropdown",{options:this.getAvailableYears(),placeholder:this.yearPlaceholder,value:this.getYearValue(),onItemSelect:this.handleChangeCurrentYear})),s("div",{class:"datepicker-select-clear"},s("button",{onClick:this.handleClear},s("mortar-icon",{kind:"close",arialabel:"close"})))),s("div",{class:"datepicker-header"},s("div",{class:"datepicker-header-previous"},s("button",{onClick:()=>this.handleChangeMonth(-1)},s("mortar-icon",{kind:"back",arialabel:"Previous Month"}))),s("div",{class:"datepicker-header-display"},s("span",null,this.getCurrentMonth())),s("div",{class:"datepicker-header-next"},s("button",{onClick:()=>this.handleChangeMonth(1)},s("mortar-icon",{kind:"next",arialabel:"Next Month"})))),s("div",{class:"datepicker-body",tabindex:"0",onFocus:this.handleCalendarFocus,onBlur:this.handleCalendarBlur},s("div",{class:"datepicker-days"},this.days.map(t=>s("div",{class:"datepicker-day"},s("div",{class:"datepicker-day-display"},s("span",null,t))))),s("div",{class:"datepicker-content"},this.getCalendarDays())))}get root(){return e(this)}static get watchers(){return{selected:["handleSelected"],open:["handleClose"],focused:["handleFocused"]}}};export{n as mortar_datepicker_calendar}